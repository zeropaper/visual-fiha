{"version":3,"sources":["webpack:///./layer/state.js","webpack:///./layer/canvas/scripts/index.js","webpack:///./layer/canvas/state.js","webpack:///./layer/img/state.js","webpack:///./layer/svg/state.js","webpack:///./layer/txt/state.js","webpack:///./layer/video/state.js","webpack:///./screen/state.js","webpack:///./layer/canvas/mocked-canvas-2d-context.js","webpack:///./layer/canvas/compile-draw-function.js","webpack:///./layer/canvas/scripts/lines/grid.js","webpack:///./layer/canvas/scripts/lines/index.js","webpack:///./layer/canvas/scripts/lines/round-frequencies.js","webpack:///./layer/canvas/scripts/loaders/index.js","webpack:///./layer/canvas/scripts/text/index.js","webpack:///./layer/canvas/scripts/text/wrap.js","webpack:///./layer/canvas/scripts/utils/fps.js","webpack:///./layer/canvas/scripts/utils/frametime.js","webpack:///./layer/canvas/scripts/utils/index.js","webpack:///./layer/collection.js","webpack:///./layer/svg/extractor.js"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6EAA6E,sBAAsB;AACnG,KAAK;AACL,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,sDAAsD;AACtD,2CAA2C;AAC3C,8CAA8C;AAC9C;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,CAAC;;AAED;;AAEA,4B;;;;;;;;AC5GA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA,4CAA4C,qBAAqB,EAAE;AACnE,GAAG;;AAEH;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B,YAAY;AACvC;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;;AAEA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,CAAC,E;;;;;;;;AC9KD;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,CAAC,E;;;;;;;;ACVD;AACA;AACA;;AAEA;AACA;AACA,4CAA4C,WAAW,EAAE;AACzD;AACA,GAAG;AACH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,CAAC,E;;;;;;;;ACpFD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,+B;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,CAAC,E;;;;;;;;ACVD;AACA;;AAEA;AACA;AACA,+CAA+C;AAC/C;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA,wCAAwC;AACxC;AACA;AACA;AACA,MAAM,EAAE;AACR;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;;;;;;;;;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,wBAAwB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH,2B;;;;;;;;AC3EA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,eAAe;AAC5B,eAAe,kBAAkB;AACjC;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA,iBAAiB,WAAW;AAC5B;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,+BAA+B;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,8DAA8D,MAAM,2BAA2B,EAAE,WAAW,GAAG;AAC/G,GAAG;AACH;AACA;AACA,iFAAiF,yBAAyB,wBAAwB,EAAE,yBAAyB,GAAG;AAChK,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,6DAA6D;AAC7D,GAAG;;;AAGH;AACA,SAAS;;AAET;AACA;AACA;;AAEA;AACA,iCAAiC;AACjC,kCAAkC;AAClC;AACA;AACA;AACA;AACA,mCAAmC,2BAA2B,uBAAuB;AACrF;AACA,gCAAgC;AAChC;AACA;AACA,gCAAgC;AAChC;;AAEA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA,kCAAkC,oCAAoC;AACtE,wCAAwC,2BAA2B;AACnE,oCAAoC,uBAAuB;AAC3D,iCAAiC,yBAAyB;AAC1D,iCAAiC,yBAAyB;AAC1D,iCAAiC,yBAAyB;AAC1D,oCAAoC,4BAA4B;AAChE,sCAAsC,8BAA8B;AACpE,kCAAkC,0BAA0B;AAC5D,0CAA0C,kCAAkC;AAC5E,6CAA6C,qCAAqC;;;AAGlF,cAAc,0BAA0B;AACxC;AACA,CAAC,IAAI;AACL,eAAe;AACf;AACA;;AAEA,iC;;;;;;;;ACzSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,WAAW;AACxB;AACA;AACA;AACA,oCAAoC;AACpC,uCAAuC,oBAAoB;AAC3D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AC5EA;AACA;AACA;AACA;AACA;AACA,E;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,oBAAoB,aAAa;AACjC;AACA;AACA;;AAEA;AACA,kBAAkB,kBAAkB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe,kBAAkB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA,E;;;;;;;;ACvDA;AACA;AACA;AACA;AACA,E;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAgB,kBAAkB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,E;;;;;;;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,E;;;;;;;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,E;;;;;;;;ACbA;AACA;AACA;AACA;AACA;AACA,E;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC,E;;;;;;;;ACnCD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA,GAAG;;AAEH;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;;AAEH;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA,mBAAmB,2BAA2B;AAC9C;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,kDAAkD,mCAAmC,EAAE;AACvF,oDAAoD,8BAA8B;;AAElF,4CAA4C,aAAa;;AAEzD;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,2B","file":"0-build.js","sourcesContent":["'use strict';\nvar State = require('ampersand-state');\nvar State = require('ampersand-state');\nvar Collection = require('ampersand-collection');\n\nvar PropertyState = State.extend({\n  idAttribute: 'name',\n\n  mappable: {\n    target: ['value']\n  },\n\n  props: {\n    name: ['string', true, ''],\n    value: ['string', false, ''],\n    default: ['string', true, '']\n  }\n});\n\nvar PropertyCollection = Collection.extend({\n  mainIndex: 'name',\n  model: PropertyState\n});\n\nvar LayerState = State.extend({\n  idAttribute: 'name',\n  typeAttribute: 'type',\n\n  initialize: function() {\n    State.prototype.initialize.apply(this, arguments);\n    var state = this;\n    state.listenToAndRun(state.styleProperties, 'change', function() {\n      state.trigger('change:styleProperties', state, state.styleProperties, {styleProperties: true});\n    });\n  },\n\n  collections: {\n    styleProperties: PropertyCollection\n  },\n\n  props: {\n    name: ['string', true, null],\n    type: ['string', true, 'default'],\n    active: ['boolean', true, true],\n    opacity: {\n      type: 'number',\n      default: 100\n    },\n    zIndex: ['number', true, 0],\n    layerStyles: ['string', false, '']\n  },\n\n  derived: {\n    screenState: {\n      deps: ['collection', 'collection.parent'],\n      fn: function() {\n        return this.collection.parent;\n      }\n    },\n    hasDOM: {\n      deps: ['screenState'],\n      fn: function() {\n        return this.screenState && this.screenState.hasDOM;\n      }\n    },\n    isControllerState: {\n      deps: ['screenState'],\n      fn: function() {\n        return this.screenState && this.screenState.isControllerState;\n      }\n    },\n    location: {\n      deps: ['isControllerState', 'hasDOM'],\n      fn: function() {\n        return this.screenState ? this.screenState.location : false;\n      }\n    },\n\n    mappable: {\n      deps: [],\n      fn: function() {\n        var proto = this.constructor.prototype;\n        var keys = Object.keys(proto._definition || {}).concat(\n          Object.keys(proto._children || {}),\n          Object.keys(proto._collections || {})\n        ).filter(function(key) {\n          return key !== this.idAttribute && key !== this.typeAttribute;\n        }, this);\n\n        return {\n          source: [],\n          target: keys\n        };\n      }\n    }\n  },\n\n  _log: function(...args) {\n    this.screenState._log(...args);\n  },\n\n  toJSON: function() {\n    return State.prototype.toJSON.apply(this, arguments);\n  }\n});\n\nLayerState.types = {};\n\nmodule.exports = LayerState;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/state.js\n// module id = 264\n// module chunks = 0","'use strict';\n\nmodule.exports = {\n  lines: require('./lines'),\n  loaders: require('./loaders'),\n  text: require('./text'),\n  utils: require('./utils')\n};\n\nif (typeof window !== 'undefined') {\n  window.VF = window.VF || {};\n  window.VF.canvas = module.exports;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/scripts/index.js\n// module id = 268\n// module chunks = 0","'use strict';\nvar State = require('ampersand-state');\nvar Collection = require('ampersand-collection');\nvar ScreenLayerState = require('./../state');\nvar mockedCtx = require('./mocked-canvas-2d-context');\nvar compileFunction = require('./compile-draw-function');\nfunction drawLayerCtx() {\n  /*\n    You can access the canvas 2d context with the global ctx\n  */\n}\n\nvar CanvasLayer = State.extend({\n  scripts: require('./scripts'),\n\n  idAttribute: 'name',\n  cache: {},\n\n  props: {\n    zIndex: ['number', true, 0],\n    name: ['string', true, null],\n    active: ['boolean', true, true],\n    drawFunction: ['any', true, function() { return drawLayerCtx; }]\n  },\n\n  serialize: function() {\n    var obj = State.prototype.serialize.apply(this, arguments);\n    var returned = {};\n    var propName;\n\n\n    var props = this.serializationProps.props || [];\n    if (props.length) {\n      returned.props = {};\n    }\n\n    // var propName;\n    var def = this.constructor.prototype._definition;\n    for (propName in obj) {\n      returned[propName] = obj[propName];\n\n      if (props.indexOf(propName) > -1) {\n        returned.props[propName] = def[propName];\n      }\n    }\n\n    var type = typeof this.drawFunction;\n    if (type === 'function') {\n      returned.drawFunction = this.drawFunction.toString();\n    }\n    else if (type === 'string') {\n      returned.drawFunction = this.drawFunction;\n    }\n    returned.name = this.name;\n    return returned;\n  },\n\n  toJSON: function(...args) {\n    return this.serialize(...args);\n  },\n\n  derived: {\n    mappable: {\n      deps: ScreenLayerState.prototype._derived.mappable.deps,\n      fn: function() {\n        var mappable = ScreenLayerState.prototype._derived.mappable.fn.apply(this, arguments);\n        var targets = mappable.target.filter(function(key) {\n          return [\n            'drawFunction',\n            'screenState', // would make a circular reference if not excluded!\n            'draw'\n          ].indexOf(key) < 0;\n        });\n\n        return {\n          source: [],\n          target: targets\n        };\n      }\n    },\n\n    screenState: {\n      deps: [],\n      fn: function() {\n        return this.collection.parent.screenState;\n      }\n    },\n\n    frametime: {\n      cache: false,\n      deps: ['screenState'],\n      fn: function() {\n        if (!this.screenState) return 0;\n        return this.screenState.frametime || 0;\n      }\n    },\n    audio: {\n      cache: false,\n      deps: ['screenState'],\n      fn: function() {\n        if (!this.screenState) return {};\n        return this.screenState.audio || {};\n      }\n    },\n\n    width: {\n      deps: ['screenState', 'screenState.width'],\n      fn: function() {\n        return this.screenState.width || 400;\n      }\n    },\n    height: {\n      deps: ['screenState', 'screenState.height'],\n      fn: function() {\n        return this.screenState.height || 300;\n      }\n    },\n    draw: {\n      deps: ['drawFunction'],\n      fn: function() {\n        var fn, result, err;\n\n        try {\n          fn = compileFunction(this.drawFunction);\n          result = fn.call(this, mockedCtx);\n          err = result instanceof Error ? result : null;\n        }\n        catch(e) {\n          err = e;\n        }\n\n        if (err) {\n          console.warn('draw function error', err.stack);\n          fn = function() { return err; };\n        }\n\n        return fn.bind(this);\n      }\n    }\n  }\n});\n\nvar _CanvasLayersCache = {};\nvar CanvasLayers = Collection.extend({\n  mainIndex: CanvasLayer.prototype.idAttribute,\n\n  comparator: 'zIndex',\n\n  model: function (attrs, options) {\n    var def = {\n      props: attrs.props || {},\n      serializationProps: {\n        props: [].concat([\n          'active',\n        ], Object.keys(attrs.props || {})),\n      }\n    };\n    var Constructor = _CanvasLayersCache[attrs.name] || CanvasLayer.extend(def);\n    _CanvasLayersCache[attrs.name] = Constructor;\n    var inst =  new Constructor(attrs, options);\n    if (options.init === false) inst.initialize();\n    return inst;\n  }\n});\n\n\nmodule.exports = ScreenLayerState.types.canvas = ScreenLayerState.extend({\n  props: {\n    clear: ['number', true, 1]\n  },\n\n  collections: {\n    canvasLayers: CanvasLayers\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/state.js\n// module id = 269\n// module chunks = 0","'use strict';\nvar ScreenLayerState = require('./../state');\nmodule.exports = ScreenLayerState.types.img = ScreenLayerState.extend({\n  props: {\n    src: ['string', false, null]\n  },\n\n  initialize: function() {\n    ScreenLayerState.prototype.initialize.apply(this, arguments);\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/img/state.js\n// module id = 270\n// module chunks = 0","'use strict';\nvar ScreenLayerState = require('./../state');\nvar Extractor = require('./extractor');\n\nmodule.exports = ScreenLayerState.types.SVG = ScreenLayerState.extend({\n  props: {\n    svgStyles: ['object', true, function() { return {}; }],\n    src: ['string', false, null]\n  },\n  session: {\n    content: ['string', false, '']\n  },\n\n  derived: {\n    mappable: {\n      deps: [],\n      fn: function() {\n        return {\n          source: [],\n          target: [\n            'active',\n            'styleProperties'\n          ]\n        };\n      }\n    }\n  },\n\n  initialize: function() {\n    var svgState = this;\n    ScreenLayerState.prototype.initialize.apply(svgState, arguments);\n\n    // only load SVG content on the worker\n    if (!svgState.hasDOM) {\n      svgState.listenToAndRun(svgState, 'change:src', function() {\n        if (svgState.src) svgState.loadSVG();\n      });\n    }\n    // only create an extractor for the state used in the controller\n    else if (svgState.isControllerState) {\n      svgState.extractor = new Extractor({\n        model: svgState\n      });\n    }\n  },\n\n  loadSVG: function(done) {\n    var state = this;\n    done = done || function(err/*, obj*/) {\n      if (err) {\n        state.content = '';\n        console.warn(err.message);\n      }\n    };\n\n    if (!state.src) {\n      state.content = '';\n      return done(new Error('No src to load for ' + state.getId() + ' SVG layer'));\n    }\n\n    fetch(state.src)\n      .then(function(res) {\n        return res.text();\n      })\n      .then(function(string) {\n        state.set({\n          content: string\n        });\n        done(null, state);\n      })\n      .catch(done);\n  },\n\n  serialize: function() {\n    var obj = ScreenLayerState.prototype.serialize.apply(this, arguments);\n    obj.content = this.content;\n    return obj;\n  },\n\n  toJSON: function() {\n    var obj = ScreenLayerState.prototype.toJSON.apply(this, arguments);\n    delete obj.content;\n    return obj;\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/svg/state.js\n// module id = 271\n// module chunks = 0","'use strict';\nvar LayerState = require('./../state');\nvar TxtLayerState = LayerState.types.txt = LayerState.extend({\n  props: {\n    text: ['string', false, null]\n  }\n});\nmodule.exports = TxtLayerState;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/txt/state.js\n// module id = 272\n// module chunks = 0","'use strict';\nvar ScreenLayerState = require('./../state');\nmodule.exports = ScreenLayerState.types.video = ScreenLayerState.extend({\n  props: {\n    src: ['string', false, null]\n  },\n\n  initialize: function() {\n    ScreenLayerState.prototype.initialize.apply(this, arguments);\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/video/state.js\n// module id = 273\n// module chunks = 0","'use strict';\n/* global Uint8Array*/\n\nvar State = require('ampersand-state');\nvar ScreenState = State.extend({\n  initialize: function(attributes, options = {}) {\n    this._isControllerState = !!options.router;\n  },\n\n  mappable: {\n    source: ['frametime', 'midi', 'firstframetime', 'signals'],\n    target: ['layers', 'signals']\n  },\n\n  session: {\n    audio: ['object', true, function() { return {\n      bufferLength: 128,\n      frequency: new Uint8Array(128),\n      timeDomain: new Uint8Array(128)\n    }; }],\n    frametime: ['number', true, 0],\n    firstframetime: ['any', true, function () {\n      return performance.now();\n    }],\n    latency: ['number', true, 0]\n  },\n\n  collections: {\n    layers: require('./../layer/collection')\n  },\n\n  derived: {\n    hasDOM: {\n      deps: [],\n      fn: function() {\n        return typeof DedicatedWorkerGlobalScope === 'undefined';\n      }\n    },\n    isControllerState: {\n      deps: [],\n      fn: function() {\n        return this._isControllerState;\n      }\n    },\n    location: {\n      deps: ['hasDOM', 'isControllerState'],\n      fn: function() {\n        return this.isControllerState ? 'control' : (this.hasDOM ? 'screen' : 'worker');\n      }\n    }\n  },\n\n  _log: function(...args) {\n    var color = this.location === 'screen' ? 'lightblue' : (this.location === 'control' ? 'lightgreen' : 'pink');\n    var txt = args.shift();\n    console.log('%c'+ this.location[0].toUpperCase() + ': ' + txt, 'color:' + color, ...args);\n  },\n\n  toJSON: function() {\n    var obj = State.prototype.toJSON.apply(this, arguments);\n    delete obj.audio;\n    return obj;\n  }\n});\n\nmodule.exports = ScreenState;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./screen/state.js\n// module id = 32\n// module chunks = 0","'use strict';\nvar noop = function(){};\nvar mockedCtx = {\n  save: noop,\n  restore: noop,\n  scale: noop,\n  rotate: noop,\n  translate: noop,\n  transform: noop,\n  setTransform: noop,\n  resetTransform: noop,\n  createLinearGradient: noop,\n  createRadialGradient: noop,\n  createPattern: noop,\n  clearRect: noop,\n  fillRect: noop,\n  strokeRect: noop,\n  beginPath: noop,\n  fill: noop,\n  stroke: noop,\n  drawFocusIfNeeded: noop,\n  clip: noop,\n  isPointInPath: noop,\n  isPointInStroke: noop,\n  fillText: noop,\n  strokeText: noop,\n  measureText: noop,\n  drawImage: noop,\n  createImageData: noop,\n  getImageData: noop,\n  putImageData: noop,\n  getContextAttributes: noop,\n  setLineDash: noop,\n  getLineDash: noop,\n  closePath: noop,\n  moveTo: noop,\n  lineTo: noop,\n  quadraticCurveTo: noop,\n  bezierCurveTo: noop,\n  arcTo: noop,\n  rect: noop,\n  arc: noop,\n  ellipse: noop,\n  // properties\n  globalAlpha: 1,\n  globalCompositeOperation: 'source-over',\n  filter: 'none',\n  imageSmoothingEnabled: true,\n  imageSmoothingQuality: 'low',\n  strokeStyle: '#000000',\n  fillStyle: '#000000',\n  shadowOffsetX: 0,\n  shadowOffsetY: 0,\n  shadowBlur: 0,\n  shadowColor: 'rgba(0, 0, 0, 0)',\n  lineWidth: 1,\n  lineCap: 'butt',\n  lineJoin: 'miter',\n  miterLimit: 10,\n  lineDashOffset: 0,\n  font: '10px sans-serif',\n  textAlign: 'start',\n  textBaseline: 'alphabetic',\n  canvas: {width: 400, height: 300},\n  // utilities\n  _: {}\n};\nmockedCtx._.methods = Object.keys(mockedCtx)\n  .filter(function(name) {\n    return typeof mockedCtx[name] === 'function';\n  });\nmockedCtx._.properties = Object.keys(mockedCtx)\n  .filter(function(name) {\n    return name != '_' && typeof mockedCtx[name] !== 'function';\n  });\nmodule.exports = mockedCtx;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/mocked-canvas-2d-context.js\n// module id = 655\n// module chunks = 0","'use strict';\nfunction noop() {}\nvar mockedCtx = require('./mocked-canvas-2d-context');\n\n\nvar utils = {};\nutils.random = function random(multi = 100) {\n  return Math.random() * multi;\n};\n\nutils.between = function between(val, min, max) {\n  return Math.max(min, Math.min(max, val));\n};\n\n\nutils.log = function log(ctx, ...args) {\n  console.info(...args);\n};\n\n/**\n * txt\n * @param [text]\n * @param [x]\n * @param [y]\n */\nutils.txt = function txt(ctx, ...args) {\n  var text, x, y;\n  [\n    text = '',\n    x = ctx.canvas.width / 2,\n    y = ctx.canvas.height / 2,\n  ] = args;\n  ctx.fillText(text, x, y);\n};\n\n/**\n * dot\n * @param [x]\n * @param [y]\n * @param [radius]: 10\n * @param [start]: 0\n * @param [end]: 360\n */\nutils.dot = function dot(ctx, ...args) {\n  var x, y, radius, start, end;\n  [\n    x = ctx.canvas.width / 2,\n    y = ctx.canvas.height / 2,\n    radius = 10,\n    start = 0,\n    end = Math.PI * 2\n  ] = args;\n  ctx.beginPath();\n  ctx.arc(x, y, radius, start, end);\n  ctx.closePath();\n  ctx.fill();\n};\n\n/**\n * circle\n * @param [x]: <center>\n * @param [y]: <center>\n * @param [radius]: 10\n * @param [start]: 0\n * @param [end]: 360\n */\nutils.circle = function circle(ctx, ...args) {\n  var x, y, radius, start, end;\n  [\n    x = ctx.canvas.width / 2,\n    y = ctx.canvas.height / 2,\n    radius = 10,\n    start = 0,\n    end = Math.PI * 2\n  ] = args;\n  ctx.beginPath();\n  ctx.arc(x, y, radius, start, end);\n  ctx.closePath();\n  ctx.stroke();\n};\n\n\nutils.line = function line(ctx, ...args) {\n  ctx.beginPath();\n  if (typeof args[0] === 'string') {\n    ctx.strokeStyle = args.shift();\n  }\n  if (typeof args[0] === 'number') {\n    ctx.lineWidth = args.shift();\n  }\n  if (!args.length) return;\n  var point = args.shift();\n  ctx.moveTo(point[0], point[1]);\n  args.forEach(function(point) {\n    ctx.lineTo(point[0], point[1]);\n  });\n  ctx.stroke();\n};\n\n/**\n * polygone\n * @param [x]: <center>\n * @param [y]: <center>\n * @param [size]: 30\n * @param [sides]: 3\n */\nutils.polygone = function polygone(ctx, ...args) {\n  ctx.beginPath();\n  var sides, angle, i, x, y, lx, ly, size;\n  [\n    x,\n    y,\n    size = 30,\n    sides = 3\n  ] = args;\n  var shift = Math.PI * 0.5;\n  var rad = (Math.PI * 2) / sides;\n  for (i = 0; i < sides; i++) {\n    angle = rad * i + shift;\n    lx = Math.round(x + Math.cos(angle) * size);\n    ly = Math.round(y + Math.sin(angle) * size);\n    if (!i) {\n      ctx.beginPath();\n    }\n    ctx.lineTo(lx, ly);\n  }\n\n  ctx.closePath();\n  ctx.stroke();\n};\n\n\nutils.grid = function grid(width, height, itemsCount, rowsCount, process) {\n  process = typeof process === 'function' ? process : noop;\n  var r = 0,\n      c = 0,\n      xy = [0,0],\n      rowHeight = height / rowsCount,\n      columnsCount = itemsCount / rowsCount,\n      columnWidth = width / columnsCount\n  ;\n\n  // var args = [].slice.apply(arguments).map(item => typeof item);\n  // console.info(...args);\n  for (r = 0; r < rowsCount; r++) {\n    for (c = 0; c < columnsCount; c++) {\n      xy[1] = rowHeight * (r + 0.5);\n      xy[0] = columnWidth * (c + 0.5);\n      process(...xy);\n    }\n  }\n};\n\n\n/*\nfunction () {\n  var cx = width / 2;\n  var cy = height / 2;\n  var i = 0;\n  var r;\n  var s = -10;\n  fillStyle('#fff');\n  distribute(cx, cy, 12, cy, (layer.frametime % (360 * s)) / s, function(x, y, a) {\n    r = (cy / 12) * i;\n    fillText(a.toFixed(2), cx + (Math.cos(a) * r), cy + (Math.sin(a) * r));\n    i++;\n  });\n}\n*/\nutils.distribute = function distribute(x, y, itemsCount, r, tilt, process) {\n  itemsCount = itemsCount || 2;\n  tilt = tilt || 0;\n  process = typeof process === 'function' ? process : noop;\n  var i, a, args;\n  var rad = Math.PI * 2;\n  for (i = 0; i < itemsCount; i++) {\n    a = ((rad / itemsCount) * i) - Math.PI + ((rad / 360) * tilt);\n    args = [\n      x + (Math.cos(a) * r),\n      y + (Math.sin(a) * r),\n      a\n    ];\n    process(...args);\n  }\n};\n\n\n\nutils.repeat = function repeat(times, process, ...args) {\n  process = typeof process === 'function' ? process : noop;\n  for (var i = 0; i < times; i++) {\n    process(i, ...args);\n  }\n};\n\n\nutils.cacheContext = function cacheContext(ctx, cache, max) {\n  max = max || 0;\n  if (!max) return;\n\n  var w = ctx.canvas.width;\n  var h = ctx.canvas.height;\n  cache.unshift(ctx.getImageData(0, 0, w, h));\n  if (cache.length >= max) cache.pop();\n};\n\nutils.restoreContexts = function restoreContexts(ctx, cache, count, preprocess, postprocess) {\n  count = count || 1;\n  preprocess = preprocess || noop;\n  postprocess = postprocess || noop;\n  // console.info(cache.length);\n  for (var c = 1; c < count && c < cache.length; c++) {\n    if (cache[c] instanceof ImageData) {\n      try {\n        ctx.putImageData(preprocess(cache[c]), 0, 0);\n        postprocess();\n      }\n      catch (e) {\n        console.info(e.message, cache[c] instanceof ImageData);\n      }\n    }\n  }\n};\n\n\n// proxy the method and properties of the canvas context\nvar ctxProperties = '';\nmockedCtx._.methods\n  .forEach(function(name) {\n    ctxProperties += '\\nvar ' + name + ' = function(...args) { try { ctx.' + name + '(...args); } catch(e){} };';\n  });\nmockedCtx._.properties\n  .forEach(function(name) {\n    if (name !== 'canvas') ctxProperties += '\\nvar ' + name + ' = function(val) { if (val !== undefined) { ctx.' + name + ' = val; } return ctx.' + name + '; };';\n  });\n\n\n// proxy the ramda functions\nvar ramdaMethods = '';\nvar ramda = require('ramda');\nObject.keys(ramda)\n  .filter(function(name) {\n    return name.length > 1 && typeof ramda[name] === 'function';\n  })\n  .forEach(function(name) {\n    ramdaMethods += '\\nvar ' + name + ' = ramda.' + name + ';';\n  });\n\n\nfunction compileFunction(drawFunction) {\n  var fn;// jshint ignore:line\n\n  var evaled = `fn = (function() {\n  // override some stuff that should not be used\n  var navigator, window, global, document, module, exports;\n\n  return function(ctx) {\n    var width = (ctx.canvas || {}).width || 400;\n    var height = (ctx.canvas || {}).height || 300;\n    var layer = this;\n    var store = layer.cache;\n    var frametime = layer ? layer.frametime : 0;\n    var audio = layer ? layer.audio : {};\n    var bufferLength = function() { return ((layer.audio || {}).bufferLength) || 128; };\n    var frequency = function(x) {\n      return ((layer.audio || {}).frequency || [])[x] || 0;\n    };\n    var timeDomain = function(x) {\n      return ((layer.audio || {}).timeDomain || [])[x] || 0;\n    };\n\n    ${ ctxProperties }\n    /*\n    ${ ramdaMethods }\n    */\n    var random = utils.random;\n    var between = utils.between;\n    var grid = function(...args) { utils.grid(width, height, ...args); };\n    var distribute = function(...args) { utils.distribute(...args); };\n    var repeat = function(...args) { utils.repeat(...args); };\n    var log = function(...args) { utils.log(ctx, ...args); };\n    var txt = function(...args) { utils.txt(ctx, ...args); };\n    var dot = function(...args) { utils.dot(ctx, ...args); };\n    var circle = function(...args) { utils.circle(ctx, ...args); };\n    var polygone = function(...args) { utils.polygone(ctx, ...args); };\n    var line = function(...args) { utils.line(ctx, ...args); };\n    var cacheContext = function(...args) { utils.cacheContext(ctx, ...args); };\n    var restoreContexts = function(...args) { utils.restoreContexts(ctx, ...args); };\n\n\n    return (${ drawFunction.toString() })(ctx);\n  };\n})();`;\n  eval(evaled);// jshint ignore:line\n  return fn;\n}\n\nmodule.exports = compileFunction;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/compile-draw-function.js\n// module id = 669\n// module chunks = 0","'use strict';\n/* global module */\nmodule.exports = function lineGrid(ctx) {\n  ctx.strokeStyle = this.lineColor || '#000';\n  ctx.fillStyle = this.lineColor || '#000';\n  var rows = Math.max(this.pointRows || 4, 1);\n  var lw = this.lineWidth || 0;\n  var radius = Math.max(this.pointRadius || lw, 1);\n  var vol = this.screenState.audio.timeDomain;\n  var freq = this.screenState.audio.frequency;\n  var count = vol.length;//Math.max(this.pointsCount || 1, 1);\n  var twoPI = Math.PI * 2;\n  var w = ctx.canvas.width;\n  var h = ctx.canvas.height;\n  var sh = h / rows;\n  var cols = Math.round(count / rows);\n  var sw = w / cols;\n  var row = -0.5;\n  var prow;\n  // var rand = this.randFactor || 0;\n  var i;\n  var x;\n  var y;\n  var px;\n  var py;\n  var p;\n  var point;\n  var points = [];\n\n\n  // function random(factor) {\n  //   factor = factor || rand;\n  //   return Math.random() * rand * (Math.random() > 0.5 ? 1 : -1);\n  // }\n\n  ctx.lineCap = 'round';\n  ctx.lineJoin = 'round';\n  ctx.lineWidth = lw;\n  for (i = 0; i < count; i++) {\n    if (i % cols < 1) {\n      row++;\n    }\n    y = (sh * row) + (freq[i] - 12);// + random(freq[i]);\n    x = (sw * 0.5) + (sw * (i % cols));// + (freq[i] - 12);// + random(freq[i]);\n    points.push([x, y]);\n\n    if (lw) {\n      if (!px) {\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n      }\n      else {\n        if (row != prow) {\n          ctx.stroke();\n          ctx.moveTo(x, y);\n        }\n        else {\n          ctx.lineTo(x, y);\n        }\n      }\n    }\n\n    px = x;\n    py = y;\n    prow = row;\n  }\n  ctx.stroke();\n  ctx.closePath();\n\n  for (p in points) {\n    point = points[p];\n    ctx.beginPath();\n    ctx.arc(point[0], point[1], Math.min(Math.max(vol[p] * radius * 0.01, 1), sh * 0.5), 0, twoPI);\n    ctx.closePath();\n    ctx.fill();\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/scripts/lines/grid.js\n// module id = 671\n// module chunks = 0","'use strict';\n/*global module, require*/\nmodule.exports = {\n  grid: require('./grid'),\n  roundFrequencies: require('./round-frequencies')\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/scripts/lines/index.js\n// module id = 672\n// module chunks = 0","'use strict';\n/* global module */\nmodule.exports = function roundFrequencies(ctx) {\n  var audio = this.screenState.audio || {};\n  var bufferLength = audio.bufferLength;\n  var freqArray = audio.frequency;\n  var timeDomainArray = audio.timeDomain;\n\n  if (!bufferLength || !freqArray || !timeDomainArray) return;\n\n  var x = ctx.canvas.width * 0.5;\n  var y = ctx.canvas.height * 0.5;\n  var r = Math.min(x, y) - 20;\n  // var first;\n  var rad = Math.PI * 2;\n\n  var i = 0, a, td, lx, ly;\n  var original = {\n    lineWidth: ctx.lineWidth,\n    lineCap: ctx.lineCap,\n    lineJoin: ctx.lineJoin,\n    strokeStyle: ctx.strokeStyle,\n  };\n\n  ctx.lineJoin = 'round';\n  ctx.lineCap = 'round';\n\n  ctx.strokeStyle = 'red';\n  var col;\n  for (var lw = y*2; lw >= y*0.2; lw-=y*0.2) {\n    col = col === 'white' ? 'black' : 'white';\n    ctx.strokeStyle = col;\n    ctx.lineWidth = lw;\n\n    // ctx.beginPath();\n    // for (i = 0; i < bufferLength; i++) {\n    //   a = ((rad / bufferLength) * i) - Math.PI;\n    //   f = (r / 100) * (freqArray[i] / 2);\n    //   lx = Math.round(x + Math.cos(a) * f);\n    //   ly = Math.round(y + Math.sin(a) * f);\n    //   ctx.lineTo(lx, ly);\n    // }\n    // ctx.stroke();\n\n    ctx.beginPath();\n    for (i = 0; i < bufferLength; i++) {\n      a = ((rad / bufferLength) * i) - Math.PI;\n      td = (r / 100) * (timeDomainArray[i] / 2);\n      lx = Math.round(x + Math.cos(a) * td);\n      ly = Math.round(y + Math.sin(a) * td);\n      ctx.lineTo(lx, ly);\n    }\n    ctx.stroke();\n  }\n\n  ctx.lineWidth = original.lineWidth;\n  ctx.lineCap = original.lineCap;\n  ctx.lineJoin = original.lineJoin;\n  ctx.strokeStyle = original.strokeStyle;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/scripts/lines/round-frequencies.js\n// module id = 673\n// module chunks = 0","'use strict';\n/* global module */\nvar _cacheImgs = {};\nfunction loadImg(url, done) {\n  // loaded\n  if (_cacheImgs[url]) {\n    return done(null, _cacheImgs[url]);\n  }\n  // loading\n  if (_cacheImgs[url] === false) {\n    return done();\n  }\n\n  var img = new Image();\n  _cacheImgs[url] = false;\n  img.onload = function() {\n    _cacheImgs[url] = img;\n  };\n  img.src = url;\n}\n\nvar _cacheVideos = {};\nfunction loadVideo(url, done) {\n  // loaded\n  if (_cacheVideos[url]) {\n    return done(null, _cacheVideos[url]);\n  }\n  // loading\n  if (_cacheVideos[url] === false) {\n    return done();\n  }\n\n  var video = document.createElement('video');\n  _cacheVideos[url] = false;\n\n  video.loop = true;\n  video.autoplay = true;\n  video.autostart = true;\n  video.muted = true;\n  video.volume = 0;\n  video.controls = false;\n  video.oncanplaythrough = function() {\n    if (_cacheVideos[url]) return;\n    video.width = video.videoWidth;\n    video.height = video.videoHeight;\n    _cacheVideos[url] = video;\n  };\n  video.src = url;\n}\n\n\n\nmodule.exports = {\n  img: loadImg,\n  video: loadVideo\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/scripts/loaders/index.js\n// module id = 674\n// module chunks = 0","'use strict';\n/*global module, require*/\nmodule.exports = {\n  wrap: require('./wrap')\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/scripts/text/index.js\n// module id = 675\n// module chunks = 0","/* global module */\n'use strict';\n// borrowed from http://www.html5canvastutorials.com/tutorials/html5-canvas-wrap-text-tutorial/\nmodule.exports = function wrapText(context, text, x, y, maxWidth, lineHeight) {\n  var words = text.split(' ');\n  var line = '';\n\n  for(var n = 0; n < words.length; n++) {\n    var testLine = line + words[n] + ' ';\n    var metrics = context.measureText(testLine);\n    var testWidth = metrics.width;\n    if (testWidth > maxWidth && n > 0) {\n      context.fillText(line, x, y);\n      line = words[n] + ' ';\n      y += lineHeight;\n    }\n    else {\n      line = testLine;\n    }\n  }\n  context.fillText(line, x, y);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/scripts/text/wrap.js\n// module id = 676\n// module chunks = 0","'use strict';\n/*global module */\nmodule.exports = function fps(ctx) {\n  var cx = ctx.canvas.width * 0.5;\n  var cy = ctx.canvas.height * 0.5;\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n  ctx.font = (cy * 0.25) + 'px monospace';\n\n  var cache = this.cache;\n  var screen = this.screenState;\n\n  cache.previous = cache.previous || 0;\n  var fps = Math.round(1000 / (screen.frametime - cache.previous)) + 'fps';\n  ctx.lineWidth = 3;\n  ctx.fillStyle = '#000';\n  ctx.strokeStyle = '#fff';\n  ctx.fillText(fps, cx, cy);\n  ctx.strokeText(fps, cx, cy);\n  cache.previous = screen.frametime;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/scripts/utils/fps.js\n// module id = 677\n// module chunks = 0","'use strict';\n/*global module */\nmodule.exports = function frametime(ctx) {\n  var cx = ctx.canvas.width * 0.5;\n  var cy = ctx.canvas.height * 0.5;\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n  ctx.font = (cy * 0.25) + 'px monospace';\n  var ft = Math.round(this.screenState.frametime) + 'ms';\n  ctx.fillStyle = '#000';\n  ctx.strokeStyle = '#fff';\n  ctx.fillText(ft, cx, cy);\n  ctx.strokeText(ft, cx, cy);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/scripts/utils/frametime.js\n// module id = 678\n// module chunks = 0","'use strict';\n/*global module, require*/\nmodule.exports = {\n  fps: require('./fps'),\n  frametime: require('./frametime')\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/canvas/scripts/utils/index.js\n// module id = 679\n// module chunks = 0","'use strict';\nvar assign = require('lodash.assign');\nvar Collection = require('ampersand-collection');\nvar LayerState = require('./state');\nrequire('./canvas/state');\nrequire('./video/state');\nrequire('./svg/state');\nrequire('./img/state');\nrequire('./txt/state');\n\nmodule.exports = Collection.extend({\n  comparator: 'zIndex',\n  mainIndex: 'name',\n  model: function(attrs, opts) {\n    var Constructor = LayerState.types[attrs.type] || LayerState;\n    var state = new Constructor(attrs, opts);\n    // state.on('change', function() {\n    //   opts.collection.trigger('change:layer', state);\n    // });\n    return state;\n  },\n\n  toJSON: function () {\n    return this.map(function (model) {\n      if (model.toJSON) {\n        return model.toJSON();\n      }\n      else {\n        var out = {};\n        assign(out, model);\n        delete out.collection;\n        return out;\n      }\n    });\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/collection.js\n// module id = 681\n// module chunks = 0","'use strict';\nvar State = require('ampersand-state');\n\nvar Extractor = State.extend({\n  autoRender: true,\n  template: '<div style=\"display: none\"></div>',\n\n  extractStyles: function() {\n    var styles = {};\n\n    this.svg.querySelectorAll('[style][id]').forEach(function(styledEl) {\n      styles['#' + styledEl.id] = styledEl.getAttribute('style');\n      styledEl.style = null;\n    });\n\n    return styles;\n  },\n\n  removeStylesFromContent: function() {\n    this.svg.querySelectorAll('[style][id]').forEach(function(styledEl) {\n      styledEl.style = null;\n    });\n    return this;\n  },\n\n  setPathLengths: function() {\n    var paths = this.el.querySelectorAll('path');\n    for (var p = 0; p < paths.length; p++) {\n      paths[p].style.setProperty('--path-length', paths[p].getTotalLength());\n    }\n    return this;\n  },\n\n  extractProps: function() {\n    var props = [];\n    var name, value;\n\n    for (var p = 0; p < this.svg.style.length; p++) {\n      name = this.svg.style[p];\n      value = this.svg.style.getPropertyValue(name).trim();\n\n      props.push({\n        name: name,\n        value: value,\n        default: value\n      });\n    }\n\n    this.svg.style = null;\n    return props;\n  },\n\n  extract: function() {\n    if (!this.el || this.el.innerHTML === this.model.content) return;\n    this.el.innerHTML = this.model.content;\n\n    this.svg = this.el.querySelector('svg');\n    if (!this.svg) return;\n    var svgState = this.model;\n\n    var layer = {};\n    layer[svgState.idAttribute] = svgState.getId();\n\n    layer.svgStyles = Object.keys(svgState.svgStyles).length ? this.removeStylesFromContent().model.svgStyles : this.extractStyles();\n\n    this.model.styleProperties.set(this.setPathLengths().extractProps());\n    layer.styleProperties = this.model.styleProperties.serialize();\n\n    layer.content = this.el.innerHTML;\n\n    svgState.once('change:svgStyles', function() { svgState.trigger('svg:extracted'); });\n    svgState.trigger('sendCommand', 'updateLayer', {layer: layer, broadcast: true});\n\n    svgState.set('content', layer.content, {silent: true});\n\n    return this;\n  },\n\n  initialize: function(options) {\n    this.model = options.model;\n    this.el = document.createElement('div');\n    this.listenToAndRun(this.model, 'change:content', this.extract);\n  }\n});\nmodule.exports = Extractor;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./layer/svg/extractor.js\n// module id = 687\n// module chunks = 0"],"sourceRoot":""}